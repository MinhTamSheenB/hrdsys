object FormSal37: TFormSal37
  Left = 328
  Top = 163
  Width = 850
  Height = 541
  Caption = 'FormSal37'
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  OldCreateOrder = False
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 842
    Height = 507
    Align = alClient
    BevelOuter = bvNone
    TabOrder = 0
    object PanelTitle: TTntPanel
      Left = 0
      Top = 0
      Width = 842
      Height = 36
      Align = alTop
      BevelOuter = bvNone
      Caption = 'Labor Cost-NCF'
      Color = clCream
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clBlue
      Font.Height = -16
      Font.Name = 'MS Sans Serif'
      Font.Style = []
      ParentFont = False
      TabOrder = 0
    end
    object PanelMain: TPanel
      Left = 0
      Top = 36
      Width = 842
      Height = 471
      Align = alClient
      BevelOuter = bvNone
      TabOrder = 1
      object PanelQuery: TPanel
        Left = 0
        Top = 0
        Width = 842
        Height = 52
        Align = alTop
        TabOrder = 0
        object TntGroupBox1: TTntGroupBox
          Left = 1
          Top = 1
          Width = 840
          Height = 50
          Align = alClient
          Caption = 'query_condition'
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clBlue
          Font.Height = -11
          Font.Name = 'MS Sans Serif'
          Font.Style = []
          ParentFont = False
          TabOrder = 0
          object TntLabel1: TTntLabel
            Left = 256
            Top = 19
            Width = 50
            Height = 13
            Alignment = taRightJustify
            AutoSize = False
            Caption = 'Month'
          end
          object Btn_Search: TTntBitBtn
            Left = 689
            Top = 13
            Width = 70
            Height = 25
            Caption = '(&q)uery'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWindowText
            Font.Height = -11
            Font.Name = 'MS Sans Serif'
            Font.Style = []
            ParentFont = False
            TabOrder = 0
            OnClick = Btn_SearchClick
            Glyph.Data = {
              76010000424D7601000000000000760000002800000020000000100000000100
              04000000000000010000120B0000120B00001000000000000000000000000000
              800000800000008080008000000080008000808000007F7F7F00BFBFBF000000
              FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00555555555555
              555555555555555555555555555555555555555555FF55555555555559055555
              55555555577FF5555555555599905555555555557777F5555555555599905555
              555555557777FF5555555559999905555555555777777F555555559999990555
              5555557777777FF5555557990599905555555777757777F55555790555599055
              55557775555777FF5555555555599905555555555557777F5555555555559905
              555555555555777FF5555555555559905555555555555777FF55555555555579
              05555555555555777FF5555555555557905555555555555777FF555555555555
              5990555555555555577755555555555555555555555555555555}
            NumGlyphs = 2
          end
          object btnExcel: TTntBitBtn
            Left = 764
            Top = 13
            Width = 70
            Height = 25
            Caption = 'Excel'
            TabOrder = 1
            OnClick = BtnExcelClick
          end
          object EditMonth: TTntEdit
            Left = 310
            Top = 15
            Width = 155
            Height = 21
            TabOrder = 2
          end
        end
      end
      object PanelGrid: TPanel
        Left = 0
        Top = 52
        Width = 842
        Height = 419
        Align = alClient
        TabOrder = 1
        object dbgLabor: TTntDBGrid
          Left = 1
          Top = 1
          Width = 840
          Height = 417
          Align = alClient
          DataSource = DataSource1
          Enabled = False
          FixedColor = clSkyBlue
          ImeName = #19975#33021#20116#31558'EXE'#22806#25346#29256
          Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete]
          TabOrder = 0
          TitleFont.Charset = DEFAULT_CHARSET
          TitleFont.Color = clWindowText
          TitleFont.Height = -11
          TitleFont.Name = 'MS Sans Serif'
          TitleFont.Style = []
          Columns = <
            item
              Expanded = False
              FieldName = 'MONTH'
              Width = 60
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'CURRENCY'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'Cos_ID'
              Width = 45
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'Headcount'
              Width = 55
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'PPH_Detail'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'Working_Hours'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'Overtime_Hours'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'BASE_SALARY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'OVERTIME_SALARY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'BENEFITS'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'BONUS'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'NZJ'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'EFFT_AWD'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'INSURANCE'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'Factory22'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'union2'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'PICC_BACK'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'LEAV_PAY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'TAXES_GR'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'PICC105'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'YICARD_DEDU'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'DUOXIU_KOUKUAN'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'BKBX'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'LAUN_PAY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'AXJJ'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'DEAL_PAY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'ACTU_PAY'
              Width = 80
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'LAST_ADDITION'
              Width = 80
              Visible = True
            end>
        end
        object mmoSQL: TMemo
          Left = 480
          Top = 56
          Width = 337
          Height = 289
          Lines.Strings = (
            'SELECT A.DEPT_CODE,'
            '       B.POSITION_CODE,'
            '       COUNT(A.EMP_ID) AS HEADCOUNT,'
            '       SUM(ISNULL(OVER15_HOUR, 0) + ISNULL(OVER20_HOUR, '
            '0) +'
            '           ISNULL(OVER30_HOUR, 0) + ISNULL(OVER195_HOUR, 0)) '
            'AS OVERTIME_HOURS,'
            '       CAST(SUM(ISNULL(BASE_PAY, 0) - ISNULL(ASK_PAY, 0) -'
            '                ISNULL(SUP_DEDU, 0) - ISNULL(STOP_DEDU, 0) -'
            '                ISNULL(DUOXIU_KOUKUAN, 0)) AS BIGINT) AS '
            'BASE_SALARY,'
            '       CAST(SUM(OVER_WORK) AS BIGINT) AS '
            'OVERTIME_SALARY,'
            '       CAST(SUM(ISNULL(DUTY_OFR, 0) + ISNULL(TECH_OFR, 0) +'
            '                ISNULL(MGMT_OFR, 0) + ISNULL(GRAD_OFR, 0) +'
            '                ISNULL(FULL_AWD, 0) + ISNULL(GONG_PAY, 0) +'
            '                ISNULL(MEAL_SAL, 0) + ISNULL(TE_PAY, 0) +'
            '                ISNULL(WEIXIU_BUFA, 0) + ISNULL'
            '(YEBAN_ALLOWANCE, 0) +'
            '                ISNULL(YINGY_ALLOWANCE, 0) + ISNULL'
            '(HSE_ALLOWANCE, 0) +'
            
              '                ISNULL(SAL_NIGHT, 0) + ISNULL(LAST_ADDITION, 0) ' +
              '+'
            '                ISNULL(SUPP_AGAI, 0) + ISNULL(FOSTER_PAY, 0) +'
            '                ISNULL(OTHER_TEMP, 0) + ISNULL(ENVR_OFR, 0)) AS '
            'BIGINT) AS BENEFITS,'
            '       CAST(SUM((BASE_PAY + MGMT_OFR + TECH_OFR + '
            'DUTY_OFR + GRAD_OFR) / 12 +'
            '                EFFT_AWD) AS BIGINT) AS BONUSES,'
            '       CAST(SUM((BASE_PAY + MGMT_OFR + TECH_OFR + '
            'DUTY_OFR + GRAD_OFR) / 12) AS'
            '            BIGINT) AS NZJJ,'
            '       SUM(EFFT_AWD) AS EFFT_AWD,'
            '       '
            '       CAST(SUM(ISNULL(LEAV_PAY, 0) + ISNULL(PICC_BACK, 0) +'
            
              '                ISNULL(PICC_SHE, 0) / 8 * 22 + ISNULL(PICC_SHE, ' +
              '0) / '
            '8 * 2) AS'
            '            BIGINT) AS INSURANCE,'
            '       CAST(SUM(ISNULL(PICC_BACK, 0)) AS BIGINT) AS '
            'PICC_BACK,'
            '       CAST(SUM(ISNULL(PICC_SHE, 0) / 8 * 22) AS BIGINT) AS '
            'FACTORY22,'
            '       CAST(SUM(ISNULL(PICC_SHE, 0) / 8 * 2) AS BIGINT) AS '
            'UNION2,'
            '       CAST(SUM(ISNULL(LEAV_PAY, 0)) AS BIGINT) AS LEAV_PAY,'
            '       CAST(SUM(ISNULL(TAX_PAY, 0)) AS BIGINT) AS TAX_PAY,'
            '       CAST(SUM(ISNULL(PICC_SHE, 0) + ISNULL(PICC_YI, 0) +'
            '                ISNULL(PICC_SHIYE, 0)) AS BIGINT) AS PICC10,'
            '       CAST(SUM(ISNULL(YICARD_DEDU, 0)) AS BIGINT) AS '
            'YICARD_DEDU,'
            '       CAST(SUM(ISNULL(DUOXIU_KOUKUAN, 0)) AS BIGINT) AS '
            'DUOXIU_KOUKUAN,'
            '       CAST(SUM(ISNULL(LAUN_PAY, 0)) AS BIGINT) AS '
            'LAUN_PAY,'
            '       CAST(SUM(ISNULL(DEAL_PAY, 0)) AS BIGINT) AS DEAL_PAY,'
            '       CAST(SUM(ISNULL(ACTU_PAY, 0)) AS BIGINT) AS '
            'ACTU_PAY,'
            '       CAST(SUM(ISNULL(LAST_ADDITION, 0)) AS BIGINT) AS '
            'LAST_ADDITION,'
            'CAST(SUM(ISNULL(BUKOUBAOXIAN, 0)) AS BIGINT) AS '
            'BUKOUBAOXIAN'
            '  FROM HRD_SAL_PAYMT A, HRD_PROF B'
            ' WHERE A.PAY_MON = %S'
            '   AND A.PST_CODE = B.PST_CODE'
            '   AND EXISTS (SELECT *'
            '          FROM HRD_SAL_CURRENCY C'
            '         WHERE A.PAY_MON = C.PAY_MON'
            '           AND A.EMP_ID = C.EMP_ID)'
            ' GROUP BY A.DEPT_CODE, B.POSITION_CODE')
          TabOrder = 1
          Visible = False
        end
        object Memo1: TMemo
          Left = 872
          Top = 112
          Width = 425
          Height = 321
          Lines.Strings = (
            'Memo1')
          ScrollBars = ssBoth
          TabOrder = 2
          Visible = False
        end
      end
    end
  end
  object DataSource1: TDataSource
    DataSet = cdsLabor
    Left = 280
    Top = 304
  end
  object cdsLabor: TClientDataSet
    Aggregates = <>
    Params = <>
    OnCalcFields = cdsLaborCalcFields
    Left = 240
    Top = 304
    object cdsLaborMONTH: TStringField
      DisplayLabel = 'Month'
      FieldName = 'MONTH'
      Size = 6
    end
    object cdsLaborCURRENCY: TStringField
      DisplayLabel = 'Curr Unit'
      FieldName = 'CURRENCY'
      Size = 3
    end
    object cdsLaborCos_ID: TStringField
      DisplayLabel = 'Cos ID'
      FieldName = 'Cos_ID'
      Size = 5
    end
    object cdsLaborHeadcount: TIntegerField
      DisplayLabel = '# of Wrkrs'
      FieldName = 'Headcount'
    end
    object cdsLaborPPH_Detail: TStringField
      DisplayLabel = 'Labor Type'
      FieldName = 'PPH_Detail'
      Size = 200
    end
    object cdsLaborWorking_Hours: TFloatField
      DisplayLabel = 'Nrml Hours'
      FieldName = 'Working_Hours'
    end
    object cdsLaborOvertime_Hours: TFloatField
      DisplayLabel = 'OT Hours'
      FieldName = 'Overtime_Hours'
    end
    object cdsLaborSALARY: TFloatField
      DisplayLabel = 'Base Salary'
      FieldName = 'BASE_SALARY'
    end
    object cdsLaborOVER_TIME: TFloatField
      DisplayLabel = 'OT Salary'
      FieldName = 'OVERTIME_SALARY'
    end
    object cdsLaborBENEFITS: TFloatField
      DisplayLabel = 'Benefits'
      FieldName = 'BENEFITS'
    end
    object cdsLaborBONUS: TFloatField
      DisplayLabel = 'Bonuses'
      FieldName = 'BONUS'
    end
    object cdsLaborNZJ: TFloatField
      DisplayLabel = #24180#32066#29518#37329
      FieldName = 'NZJ'
    end
    object cdsLaborEFFT_AWD: TFloatField
      DisplayLabel = #20214#36039#24046#30064
      FieldName = 'EFFT_AWD'
    end
    object cdsLaborINSURANCE: TFloatField
      DisplayLabel = 'Insurance'
      FieldName = 'INSURANCE'
    end
    object cdsLaborFactory22: TFloatField
      DisplayLabel = 'Factory 22%'
      FieldName = 'Factory22'
    end
    object cdsLaborunion2: TFloatField
      DisplayLabel = 'union 2%'
      FieldName = 'union2'
    end
    object cdsLaborPICC_BACK: TFloatField
      DisplayLabel = #20445#38570#36820#36996'22%'
      FieldName = 'PICC_BACK'
    end
    object cdsLaborLEAV_PAY: TFloatField
      DisplayLabel = 'LeaveAmt'
      FieldName = 'LEAV_PAY'
    end
    object cdsLaborTAXES_GR: TFloatField
      DisplayLabel = 'Taxes'#25187#21729#24037#20491#20154
      FieldName = 'TAXES_GR'
    end
    object cdsLaborPICC105: TFloatField
      DisplayLabel = #20445#38570'10.5'
      FieldName = 'PICC105'
    end
    object cdsLaborYICARD_DEDU: TFloatField
      DisplayLabel = #37291#20445#25187#27454
      FieldName = 'YICARD_DEDU'
    end
    object cdsLaborDUOXIU_KOUKUAN: TFloatField
      DisplayLabel = #38626#32887#25187#27454
      FieldName = 'DUOXIU_KOUKUAN'
    end
    object cdsLaborBKBX: TFloatField
      DisplayLabel = #35036#25187#20445#38570
      FieldName = 'BKBX'
    end
    object cdsLaborLAUN_PAY: TFloatField
      DisplayLabel = #24037#22296#36027'-'#25187#21729#24037#20491#20154
      FieldName = 'LAUN_PAY'
    end
    object cdsLaborAXJJ: TFloatField
      DisplayLabel = #24859#24515#22522#37329
      FieldName = 'AXJJ'
    end
    object cdsLaborDEAL_PAY: TFloatField
      DisplayLabel = #25033#20184#34218#36039
      FieldName = 'DEAL_PAY'
    end
    object cdsLaborACTU_PAY: TFloatField
      DisplayLabel = #23526#20184#34218#36039
      FieldName = 'ACTU_PAY'
    end
    object cdsLaborLAST_ADDITION: TFloatField
      DisplayLabel = #24046#30064#37329#38989
      FieldName = 'LAST_ADDITION'
    end
  end
end
